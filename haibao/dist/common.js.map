{"version":3,"file":"common.js","sources":["webpack:///videVideo.vue","webpack:///./src/components/videVideo.vue?4b6e","webpack:///./src/components/videVideo.vue?a8f5","webpack:///./src/components/videVideo.vue","webpack:///./src/components/videVideo.vue?48cf","webpack:///./src/components/videVideo.vue?c76c","webpack:///./src/components/videVideo.vue?f0ba","webpack:///./src/libs/ajax.js","webpack:///./src/libs/globalData.js","webpack:///./src/libs/mixin.js"],"sourcesContent":["<!--页面底部-->\n<template>\n  <view class=\"full-screen-float\" v-if=\"viewVideoSrc\">\n    <video :src=\"viewVideoSrc\" :autoplay='true' :controls=\"true\"></video>\n    <image src=\"https://campaign5.method-ad.cn/hypertherm/img/icon_close.png\" class=\"close\" @tap=\"close\"></image>\n  </view>\n</template>\n<script>\nexport default {\n  name: 'sidebar',\n  props: ['viewVideoSrc'],\n  mounted() {\n\n  },\n  methods: {\n    close(){\n        this.$emit('update:viewVideoSrc','');\n    }\n  }\n}\n\n</script>\n<style lang=\"scss\">\n.full-screen-float {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100vh;\n  background-color: rgba(0, 0, 0, 0.6);\n  z-index: 1000;\n\n  video {\n    width: 100%;\n    height: 100%;\n    background-color: #000;\n  }\n\n  .close {\n    position: absolute;\n    top: 30px;\n    right: 30px;\n    width: 50px;\n    height: 50px;\n  }\n}\n\n</style>\n","// extracted by mini-css-extract-plugin","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _vm.viewVideoSrc\n    ? _c(\"view\", { staticClass: \"full-screen-float\" }, [\n        _c(\"video\", {\n          attrs: { src: _vm.viewVideoSrc, autoplay: true, controls: true }\n        }),\n        _vm._v(\" \"),\n        _c(\"image\", {\n          staticClass: \"close\",\n          attrs: {\n            src: \"https://campaign5.method-ad.cn/hypertherm/img/icon_close.png\"\n          },\n          on: { tap: _vm.close }\n        })\n      ])\n    : _vm._e()\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./videVideo.vue?vue&type=template&id=0e128f07&\"\nimport script from \"./videVideo.vue?vue&type=script&lang=js&\"\nexport * from \"./videVideo.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  var style0 = require(\"./videVideo.vue?vue&type=style&index=0&lang=scss&\")\nif (style0.__inject__) style0.__inject__(context)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/_vue-loader@15.9.6@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  null,\n  \"f6adca88\"\n  \n)\n\ncomponent.options.__file = \"src/components/videVideo.vue\"\nexport default component.exports","import mod from \"-!../../node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js!../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./videVideo.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js!../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./videVideo.vue?vue&type=script&lang=js&\"","export * from \"-!../../node_modules/_mini-css-extract-plugin@0.8.0@mini-css-extract-plugin/dist/loader.js!../../node_modules/_css-loader@3.6.0@css-loader/dist/cjs.js??ref--1-oneOf-0-1!../../node_modules/_vue-loader@15.9.6@vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??postcss!../../node_modules/_sass-loader@8.0.2@sass-loader/dist/cjs.js??ref--1-oneOf-0-3!../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./videVideo.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../node_modules/_vue-loader@15.9.6@vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./videVideo.vue?vue&type=template&id=0e128f07&\"","import Taro from '@tarojs/taro';\nimport { createCache } from \"./globalData\";\nconst globalData = createCache();\n// c.set(\"test\", 100);\n// console.log(c.get(\"test\"));\n\nconst DOMAIN = 'https://campaign5.method-ad.cn/hypertherm/';\nexport function getOpenid() {\n    return new Promise((resolve, reject) => {\n        var openid = globalData.get(\"openid\");\n        if(openid){\n            resolve(openid);\n        }else{\n            wx.login({\n              success (res) {\n                if (res.code) {\n                  Taro.request({\n                        url: DOMAIN + 'xcx_request.php?rndv='+Math.random() + '&act=getOpenid',\n                        data: {\n                            code:res.code\n                        },\n                        method:'post',\n                        header:{\n                            'Content-Type':'application/x-www-form-urlencoded'\n                        },\n                        success (res) {\n                            if(res.data.status == 1){\n                                globalData.set('openid',res.data.openid);\n                                resolve(res.data.openid);\n                            }\n                        },\n                        fail(e){\n                            reject(e);\n                        }\n                    });\n                } else {\n                  console.log('登录失败！' + res.errMsg)\n                }\n              }\n            });\n        }\n    })\n}\nexport function ajax(options = {}) {\n    return new Promise((resolve, reject) => {\n        getOpenid().then(openid=>{\n            let obj = Object.assign({}, options.data || {}, {openid:openid});\n            Taro.request({\n                url: DOMAIN + options.url + '?rndv='+Math.random() + '&act='+obj.act,\n                data: {...obj,act:options.data.act2 || '' },\n                method:'post',\n                header:{\n                    'Content-Type':'application/x-www-form-urlencoded'\n                },\n                success (res) {\n                    resolve(res.data);\n                },\n                fail(e){\n                    reject(e);\n                }\n            });\n        })\n    })\n};\n","export function createCache() {\n    const globalData = {\n      \n    };\n    return {\n      set(key, val) {\n        globalData[key] = val;\n        wx.setStorageSync(key, val);\n      },\n      get(key) {\n        return wx.getStorageSync(key) || '';\n      }\n    }\n  }\n  ","import { ajax } from \"./ajax\";\n\nexport default {\n  data() {\n    return {\n      containerTop: 0\n    }\n  },\n  created() {\n    let menuButtonObject = wx.getMenuButtonBoundingClientRect();\n    this.containerTop = menuButtonObject.height + menuButtonObject.top + 10;\n  },\n  methods: {\n    viewVideo(item) {\n      this.viewVideoSrc = item.video_filename;\n    },\n    toViewPdf(item, tp = 100) {\n      wx.navigateTo({ url: '/pages/webview/index?src=' + item.pdf_filename + '&title=' + item.title });\n\n      ajax({\n        url: 'xcx_request.php',\n        data: {\n          act: 'set_File_History',\n          act2: 'read',\n          tp: this.$store.state.category,\n          tp_value: item.class_id || item.tech_detail_id,\n          file_tp: 'pdf',\n          watch_time: 0,\n        },\n      });\n      // wx.downloadFile({\n      //   // 示例 url，并非真实存在\n      //   url:item.pdf_filename,\n      //   success: function (res) {\n      //     const filePath = res.tempFilePath\n      //     wx.openDocument({\n      //       filePath: filePath,\n      //       success: function (res) {\n      //         console.log('打开文档成功')\n      //       }\n      //     })\n      //   }\n      // })\n    },\n    toViewVideo(item, tp = 100) {\n      wx.navigateTo({ url: '/pages/server/video?title=' + item.title + '&video_filename=' + item.video_filename + '&video_picture=' + item.video_picture + '&id=' + (item.class_id || item.tech_detail_id) });\n    },\n    downloadPdf(item, tp = 100) {\n      wx.showLoading({\n        title: '加载中...',\n      })\n      const fileExtName = \".pdf\";\n      const randfile = new Date().getTime() + fileExtName;\n      const newPath = `${wx.env.USER_DATA_PATH}/${randfile}`;\n      wx.downloadFile({\n        url: item.pdf_filename,\n        filePath: newPath,\n        success: res => {\n          let filePath = res.tempFilePath;\n          wx.openDocument({\n            filePath: newPath,\n            showMenu: true,\n            fileType: 'pdf',\n            success: function(res) {}\n          })\n          wx.hideLoading();\n        }\n      });\n\n\n      ajax({\n        url: 'xcx_request.php',\n        data: {\n          act: 'set_File_History',\n          act2: 'download',\n          tp: this.$store.state.category,\n          tp_value: item.class_id || item.tech_detail_id,\n          file_tp: 'pdf',\n          watch_time: 0,\n        },\n      });\n    },\n    downloadVideo(item, tp = 100) {\n      wx.showLoading({\n        title: '加载中...',\n      })\n      wx.downloadFile({\n        url: item.video_filename,\n        success: res => {\n          let filePath = res.tempFilePath;\n          console.log(res);\n          wx.saveVideoToPhotosAlbum({\n            filePath: filePath,\n            success: file => {\n              wx.showToast({\n                title: '已保存到相册',\n                icon: 'none',\n                duration: 2000,\n              })\n              wx.hideLoading();\n            },\n            fail: err => {\n              console.log(err)\n              wx.showToast({\n                title: '获取权限失败，将无法保存到相册哦~',\n                icon: 'none',\n                duration: 2000,\n              })\n              wx.hideLoading();\n            }\n          })\n        }\n      });\n\n\n      ajax({\n        url: 'xcx_request.php',\n        data: {\n          act: 'set_File_History',\n          act2: 'download',\n          tp: this.$store.state.category,\n          tp_value: item.class_id || item.tech_detail_id,\n          file_tp: 'video',\n          watch_time: 0,\n        },\n      });\n    }\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAQA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AAHA;AANA;;;;;;;;;;;;ACRA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACtBA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACxBA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;ACAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAjBA;AAmBA;AACA;AACA;AACA;AAzBA;AA2BA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AAZA;AAcA;AACA;AACA;AAAA;;;;;;;;;;;;;AC/DA;AAAA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AASA;;;;;;;;;;;;;ACbA;AAAA;AAEA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AAFA;AAYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AAZA;AAgBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AAFA;AAWA;AACA;AAAA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AAlBA;AAoBA;AAzBA;AA6BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AAFA;AAWA;AAlHA;AAVA;;;;A","sourceRoot":""}